{% extends "base.html" %}

{% block title %}Interne{% endblock %}

{% block header_left %}
<div id="view-filter" class="view-filter">
    <a href="/" class="view-filter-link{% if filter == "ready" %} active{% endif %}" hx-get="/" hx-target="#entry-list" hx-select="#entry-list" hx-select-oob="#view-filter" hx-swap="outerHTML" hx-push-url="true">Ready</a>
    /
    <a href="/waiting" class="view-filter-link{% if filter == "waiting" %} active{% endif %}" hx-get="/waiting" hx-target="#entry-list" hx-select="#entry-list" hx-select-oob="#view-filter" hx-swap="outerHTML" hx-push-url="true">Waiting</a>
    /
    <a href="/unseen" class="view-filter-link{% if filter == "unseen" %} active{% endif %}" hx-get="/unseen" hx-target="#entry-list" hx-select="#entry-list" hx-select-oob="#view-filter" hx-swap="outerHTML" hx-push-url="true">Unseen</a>
    /
    <a href="/all" class="view-filter-link{% if filter == "all" %} active{% endif %}" hx-get="/all" hx-target="#entry-list" hx-select="#entry-list" hx-select-oob="#view-filter" hx-swap="outerHTML" hx-push-url="true">All</a>
</div>
{% endblock %}

{% block header_actions %}
<div class="header-actions">
    <input type="search" id="search-input" placeholder="Search links..." autocomplete="off" spellcheck="false">
    <a href="/entries/new">+ New Link</a>
</div>
{% endblock %}

{% block content %}
<div id="entry-list" class="entry-list">
    {% if entries.is_empty() %}
    <p class="empty">
        {% if filter == "ready" %}
            Nothing due. Go outside!
        {% else if filter == "waiting" %}
            Nothing waiting. Everything is ready!
        {% else if filter == "unseen" %}
            No unseen links.
        {% else %}
            No links yet. Add one!
        {% endif %}
    </p>
    {% else %}
        {% for entry in entries %}
            {% include "entries/entry.html" %}
        {% endfor %}
    {% endif %}
</div>

<script>
(function() {
    var input = document.getElementById('search-input');
    var list = document.getElementById('entry-list');
    var timer;
    input.addEventListener('input', function() {
        clearTimeout(timer);
        timer = setTimeout(function() {
            var q = input.value.toLowerCase();
            var entries = list.querySelectorAll('.entry');
            for (var i = 0; i < entries.length; i++) {
                var haystack = entries[i].getAttribute('data-search').toLowerCase();
                entries[i].style.display = (!q || haystack.indexOf(q) !== -1) ? '' : 'none';
            }
        }, 150);
    });
})();
</script>
{% endblock %}

